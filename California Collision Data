#In this SQL, I'm querying a database from the California Highway Patrol that covers collisions from January 1st, 2001 until mid-December, 2020.


---What days in the year 2009 were there more than three bicyclists who complained about pain or 
got severely injured after being a victim in an accident at dusk or dawn?

SELECT collision_date, COUNT(victim_role) AS bicyclist FROM parties
INNER JOIN victims ON parties.case_id = victims.case_id
INNER JOIN collisions ON collisions.case_id = victims.case_id
WHERE collision_date BETWEEN ('2009-01-01') AND ('2009-12-31')
AND victim_role IN ('bicyclist')
AND lighting IN ('dusk or dawn')
AND victim_degree_of_injury IN ('complaint of pain', 'severe injury')
GROUP BY collision_date
HAVING COUNT(victim_role) > 3
ORDER BY collision_date ASC;


---How many collisions were caused by male and female parties under the influence in Los Angeles County?  

SELECT party_sex, COUNT(alcohol_involved) AS alcohol_involved FROM collisions
JOIN parties
ON collisions.case_id = parties.case_id
WHERE party_sex IS NOT null AND party_sex != 'X'
AND county_location IN ('los angeles')
GROUP BY party_sex


---How many fatal collisions occured from speeding on the highway?

SELECT COUNT(location_type) AS highway_collisions FROM collisions
WHERE location_type IN ('highway')
AND collision_severity IN ('fatal')
AND pcf_violation_category IN ('speeding')


